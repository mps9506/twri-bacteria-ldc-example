<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>LDC Example</title>
  <meta name="description" content="LDC Example" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="LDC Example" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="mps9506/twri-bookdown-template" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="LDC Example" />
  
  
  

<meta name="author" content="Michael Schramm" />


<meta name="date" content="2021-05-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">TEMPLATE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path=""><a href="#step-1"><i class="fa fa-check"></i>Step 1</a></li>
<li class="chapter" data-level="" data-path=""><a href="#step-2"><i class="fa fa-check"></i>Step 2</a></li>
<li class="chapter" data-level="" data-path=""><a href="#step-3"><i class="fa fa-check"></i>Step 3</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#flow-duration-curve"><i class="fa fa-check"></i>Flow Duration Curve</a></li>
<li class="chapter" data-level="" data-path=""><a href="#ldc"><i class="fa fa-check"></i>LDC</a></li>
<li class="chapter" data-level="" data-path=""><a href="#final-plot"><i class="fa fa-check"></i>Final plot</a></li>
</ul></li>
<li class="chapter" data-level="" data-path=""><a href="#references"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">LDC Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">LDC Example</h1>
<p class="author"><em>Michael Schramm</em></p>
<p class="date" style="margin-top: 1.5em;"><em>2021-05-18</em></p>
</div>
<div id="step-1" class="section level1 unnumbered">
<h1>Step 1</h1>
<p>Setup the project in R Studio. Use “File -&gt; New Project,” name your project and select the directory to store your project. I always recomend setting up a couple of folder for all project workflows, this can be adjusted based on project needs but this provides a good starting point:</p>
<pre><code>Home Folder
  |
  |-RawData
  |-ExportData
  |-Figures
  |-Scripts
  projectname.Rproj
  readme.md
  </code></pre>
<p>The idea in this file structure is that we never want to alter the raw data we are manipulating. All data manipulation is done via the scripts and stored in memory and written to a different exported data file.</p>
</div>
<div id="step-2" class="section level1 unnumbered">
<h1>Step 2</h1>
<p>Install and load the required packages. Use <code>install.packages(dataRetrieval)</code> as needed to install required packages.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dataRetrieval) <span class="do">## for USGS daily streamflow data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor) <span class="do">## cleans up messy variable names</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="do">## uncomment the line below to install</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(remotes)</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github(&quot;mps9506/dartx&quot;)</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dartx)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span></code></pre></div>
</div>
<div id="step-3" class="section level1 unnumbered">
<h1>Step 3</h1>
<p>We have two general scenarios we need to consider. The easiest is when there is a monitoring station right next to a stream flow gage. This way we can estimate bacteria loads (count units) using measured streamflow (water volume) and measured bacteria concentration. Concentration times volume equals counts or mass.</p>
<p>The second scenario is when there is no streamflow data where the bacteria data is collected. We need to estimate the streamflow at the water quality site. If there is a stream gage upstream or downstream of our stie of interest, a simple drainage area ratio works well. the <code>dartx</code> package provides an empriically measured adjustment factor to the drainage area ratio as applied in Texas.</p>
<p>One caveat, if this is being done for a TMDL (or TSD in preperation for a TMDL), we have to account for wastewater permits, future growth and water rights on streamflow. I am not concerned about that for this example.</p>
<p>Start with the basic example. This example uses Tres Palacios Creek SWQM station 12517. There is a USGS gage, 08162600 located at the site. The bacteria data has been downloaded manually from SWQMIS and is in pipe delmminated format in the RawData folder. The streamflow data will be downloaded from USGS and stored in the RawData folder for future use.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the bacteria data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df_12517 <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">&quot;RawData/SWQM-12517-P31699.txt&quot;</span>, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;|&quot;</span>, <span class="at">escape_double =</span> <span class="cn">FALSE</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">Segment =</span> <span class="fu">col_character</span>(), </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Station ID</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">col_character</span>(), <span class="st">`</span><span class="at">Parameter Code</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">col_character</span>(), </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">End Date</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">col_date</span>(<span class="at">format =</span> <span class="st">&quot;%m/%d/%Y&quot;</span>), </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">End Time</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">col_skip</span>(), <span class="st">`</span><span class="at">End Depth</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">col_skip</span>(), </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Start Date</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">col_skip</span>(), <span class="st">`</span><span class="at">Start Time</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">col_skip</span>(), </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Start Depth</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">col_skip</span>(), <span class="st">`</span><span class="at">Composite Category</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">col_skip</span>(), </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Composite Type</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">col_skip</span>(), <span class="st">`</span><span class="at">Submitting Entity</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">col_skip</span>(), </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Collecting Entity</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">col_skip</span>(), </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Monitoring Type</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">col_skip</span>(), <span class="at">Comments =</span> <span class="fu">col_skip</span>()), </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">trim_ws =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>df_12517 <span class="ot">&lt;-</span> <span class="fu">clean_names</span>(df_12517)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>df_12517</span></code></pre></div>
<pre><code>## # A tibble: 72 x 9
##    rfa_sample_set_id_t… segment station_id station_description    parameter_code
##    &lt;chr&gt;                &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;                  &lt;chr&gt;         
##  1 R212870              1502    12517      TRES PALACIOS CREEK A… 31699         
##  2 R216644              1502    12517      TRES PALACIOS CREEK A… 31699         
##  3 R218189              1502    12517      TRES PALACIOS CREEK A… 31699         
##  4 1444077              1502    12517      TRES PALACIOS CREEK A… 31699         
##  5 1478385              1502    12517      TRES PALACIOS CREEK A… 31699         
##  6 1643855              1502    12517      TRES PALACIOS CREEK A… 31699         
##  7 WR1104N              1502    12517      TRES PALACIOS CREEK A… 31699         
##  8 R194025              1502    12517      TRES PALACIOS CREEK A… 31699         
##  9 1342329              1502    12517      TRES PALACIOS CREEK A… 31699         
## 10 10035889             1502    12517      TRES PALACIOS CREEK A… 31699         
## # … with 62 more rows, and 4 more variables: parameter_description &lt;chr&gt;,
## #   greater_than_less_than &lt;chr&gt;, value &lt;dbl&gt;, end_date &lt;date&gt;</code></pre>
<p>This code chunk will download the streamflow data. I usually write this in a sepearte script so I only have to run it one time and write the output file to the raw data folder. The main script will read the data from the raw data folder instead of trying to download the data every single time we run the script.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># download mean daily streamflow and write to csv</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>Q_df <span class="ot">&lt;-</span> <span class="fu">readNWISdv</span>(<span class="at">siteNumbers =</span> <span class="st">&quot;08162600&quot;</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">startDate =</span> <span class="st">&quot;2000-01-01&quot;</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">endDate =</span> <span class="st">&quot;2020-12-31&quot;</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">parameterCd =</span> <span class="st">&quot;00060&quot;</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">statCd =</span> <span class="st">&quot;00003&quot;</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>Q_df <span class="ot">&lt;-</span> <span class="fu">renameNWISColumns</span>(Q_df)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(Q_df,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;RawData/meandailyQ_08162600.csv&quot;</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(Q_df)</span></code></pre></div>
<pre><code>## # A tibble: 7,671 x 5
##    agency_cd site_no  Date        Flow Flow_cd
##    &lt;chr&gt;     &lt;chr&gt;    &lt;date&gt;     &lt;dbl&gt; &lt;chr&gt;  
##  1 USGS      08162600 2000-01-01  0.84 A      
##  2 USGS      08162600 2000-01-02  3    A      
##  3 USGS      08162600 2000-01-03  3.4  A      
##  4 USGS      08162600 2000-01-04  2.6  A      
##  5 USGS      08162600 2000-01-05  1.6  A      
##  6 USGS      08162600 2000-01-06  3.2  A      
##  7 USGS      08162600 2000-01-07 11    A      
##  8 USGS      08162600 2000-01-08 17    A      
##  9 USGS      08162600 2000-01-09 22    A      
## 10 USGS      08162600 2000-01-10 18    A      
## # … with 7,661 more rows</code></pre>
<p>Always do a quick exploratory plot of the data. Nothing stands out on the plots below. We could do some more exploration but I don’t think it is needed here.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_12517) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(end_date, value)) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span></code></pre></div>
<p><img src="document_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Q_df) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(Date, Flow))</span></code></pre></div>
<p><img src="document_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<div id="flow-duration-curve" class="section level2">
<h2>Flow Duration Curve</h2>
<p>Now we make a flow duration curve by calculating the probablity that a flow on any given day will be exceeded.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>Q_df <span class="ot">&lt;-</span> Q_df <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, Flow) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FlowExceedance =</span> <span class="dv">1</span><span class="sc">/</span>(<span class="fu">length</span>(Flow)<span class="sc">/</span><span class="fu">rank</span>(<span class="sc">-</span>Flow))) <span class="do">## this calculates the prob of flow being exceeded</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(Q_df)</span></code></pre></div>
<pre><code>## # A tibble: 7,671 x 3
##    Date        Flow FlowExceedance
##    &lt;date&gt;     &lt;dbl&gt;          &lt;dbl&gt;
##  1 2000-01-01  0.84          0.999
##  2 2000-01-02  3             0.993
##  3 2000-01-03  3.4           0.990
##  4 2000-01-04  2.6           0.994
##  5 2000-01-05  1.6           0.998
##  6 2000-01-06  3.2           0.991
##  7 2000-01-07 11             0.811
##  8 2000-01-08 17             0.580
##  9 2000-01-09 22             0.443
## 10 2000-01-10 18             0.545
## # … with 7,661 more rows</code></pre>
<p>We can plot the FDC now as:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Q_df) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(FlowExceedance,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                Flow)) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Proportion Time Flow Exceeded&quot;</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Flow (cfs)&quot;</span>)</span></code></pre></div>
<p><img src="document_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="ldc" class="section level2">
<h2>LDC</h2>
<p>The next step is to convert the FDC to an LDC with bacteria data. The steps are to multiply the flow by the instream bacteria standard. This tells us the allowable bacteria loading in the stream under different flow exceedance conditions.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>Q_df <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## MPN/100mL * cubic feet/sec * mL/cubic feet * sec/day = mpn/day</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">LDC =</span> (<span class="dv">126</span><span class="sc">/</span><span class="dv">100</span>) <span class="sc">*</span> Flow <span class="sc">*</span> <span class="fl">28316.8</span> <span class="sc">*</span> <span class="dv">86400</span>) <span class="ot">-&gt;</span> Q_df</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Q_df) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(FlowExceedance, LDC)) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Proportion Time Load Exceeded&quot;</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>       <span class="do">## sorry, stupid way to get italics into labels</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;E. coli&quot;</span>), <span class="st">&quot; (MPN/day)&quot;</span>)))</span></code></pre></div>
<p><img src="document_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Now we want to overlay the measured bacteria data as loads on the LDC. So we pair the bacteria data by date to flow, then convert the concentration to a daily load and add it to the plot.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Q_df <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(df_12517 <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(end_date, value),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Date&quot;</span> <span class="ot">=</span> <span class="st">&quot;end_date&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MeasuredLoad =</span> (value<span class="sc">/</span><span class="dv">100</span>) <span class="sc">*</span> Flow <span class="sc">*</span> <span class="fl">28316.8</span> <span class="sc">*</span> <span class="dv">86400</span>) <span class="ot">-&gt;</span> Q_df</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(Q_df)</span></code></pre></div>
<pre><code>## # A tibble: 7,671 x 6
##    Date        Flow FlowExceedance          LDC value MeasuredLoad
##    &lt;date&gt;     &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;
##  1 2000-01-01  0.84          0.999  2589451297.    NA           NA
##  2 2000-01-02  3             0.993  9248040346.    NA           NA
##  3 2000-01-03  3.4           0.990 10481112392.    NA           NA
##  4 2000-01-04  2.6           0.994  8014968300.    NA           NA
##  5 2000-01-05  1.6           0.998  4932288184.    NA           NA
##  6 2000-01-06  3.2           0.991  9864576369.    NA           NA
##  7 2000-01-07 11             0.811 33909481267.    NA           NA
##  8 2000-01-08 17             0.580 52405561958.    NA           NA
##  9 2000-01-09 22             0.443 67818962534.    NA           NA
## 10 2000-01-10 18             0.545 55488242074.    NA           NA
## # … with 7,661 more rows</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Q_df) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(FlowExceedance, LDC,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">linetype =</span> <span class="st">&quot;Allowable Load at Geomean Criterion (126 MPN/100 mL)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(FlowExceedance, MeasuredLoad,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> <span class="st">&quot;Measurement Value (MPN/day)&quot;</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;Measurement Value (MPN/day)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Proportion Time Load Exceeded&quot;</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;E. coli&quot;</span>), <span class="st">&quot; (MPN/day)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">name =</span> <span class="st">&quot;values&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">&quot;values&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;dodgerblue4&quot;</span>)) <span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">5</span>))</span></code></pre></div>
<pre><code>## Warning: Removed 7599 rows containing missing values (geom_point).</code></pre>
<p><img src="document_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Now we need to split the flow exceedance into different categories and summarize the loads by category. Here we make a summary table that we can add to our ggplot.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>load_summary <span class="ot">&lt;-</span> Q_df <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Flow_Condition =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    FlowExceedance <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> FlowExceedance <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">&quot;Highest Flows&quot;</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    FlowExceedance <span class="sc">&gt;=</span> <span class="fl">0.1</span> <span class="sc">&amp;</span> FlowExceedance <span class="sc">&lt;</span> <span class="fl">0.4</span> <span class="sc">~</span> <span class="st">&quot;Moist Conditions&quot;</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    FlowExceedance <span class="sc">&gt;=</span> <span class="fl">0.4</span> <span class="sc">&amp;</span> FlowExceedance <span class="sc">&lt;</span> <span class="fl">0.6</span> <span class="sc">~</span> <span class="st">&quot;Mid-Range Flows&quot;</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    FlowExceedance <span class="sc">&gt;=</span> <span class="fl">0.6</span> <span class="sc">&amp;</span> FlowExceedance <span class="sc">&lt;</span> <span class="fl">0.9</span> <span class="sc">~</span> <span class="st">&quot;Dry Conditions&quot;</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    FlowExceedance <span class="sc">&gt;=</span> <span class="fl">0.9</span> <span class="sc">&amp;</span> FlowExceedance <span class="sc">&lt;=</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;Lowest Flows&quot;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    FlowExceedance <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> FlowExceedance <span class="sc">&lt;=</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="fl">0.05</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    FlowExceedance <span class="sc">&gt;</span> <span class="fl">0.1</span> <span class="sc">&amp;</span> FlowExceedance <span class="sc">&lt;=</span> <span class="fl">0.4</span> <span class="sc">~</span> <span class="fl">0.25</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    FlowExceedance <span class="sc">&gt;</span> <span class="fl">0.4</span> <span class="sc">&amp;</span> FlowExceedance <span class="sc">&lt;=</span> <span class="fl">0.6</span> <span class="sc">~</span> <span class="fl">0.5</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    FlowExceedance <span class="sc">&gt;</span> <span class="fl">0.6</span> <span class="sc">&amp;</span> FlowExceedance <span class="sc">&lt;=</span> <span class="fl">0.9</span> <span class="sc">~</span> <span class="fl">0.75</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    FlowExceedance <span class="sc">&gt;</span> <span class="fl">0.9</span> <span class="sc">&amp;</span> FlowExceedance <span class="sc">&lt;=</span> <span class="dv">1</span> <span class="sc">~</span> <span class="fl">0.95</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Flow_Condition, p) <span class="sc">%&gt;%</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">quantileflow =</span> <span class="fu">round</span>(<span class="fu">quantile</span>(Flow, .<span class="dv">5</span>, <span class="at">type =</span> <span class="dv">5</span>, <span class="at">names =</span> <span class="cn">FALSE</span>), <span class="dv">3</span>),</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">geomean_sample =</span> DescTools<span class="sc">::</span><span class="fu">Gmean</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">calcload =</span> quantileflow <span class="sc">*</span> geomean_sample<span class="sc">/</span><span class="dv">100</span> <span class="sc">*</span> <span class="fl">28316.8</span> <span class="sc">*</span> <span class="dv">86400</span>)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Flow_Condition&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>load_summary</span></code></pre></div>
<pre><code>## # A tibble: 5 x 5
## # Groups:   Flow_Condition [5]
##   Flow_Condition       p quantileflow geomean_sample calcload
##   &lt;chr&gt;            &lt;dbl&gt;        &lt;dbl&gt;          &lt;dbl&gt;    &lt;dbl&gt;
## 1 Dry Conditions    0.75         12.6           68.9  2.12e10
## 2 Highest Flows     0.05        542            459.   6.08e12
## 3 Lowest Flows      0.95          6.9          103.   1.74e10
## 4 Mid-Range Flows   0.5          19.7          109.   5.27e10
## 5 Moist Conditions  0.25         40.7          193.   1.92e11</code></pre>
</div>
<div id="final-plot" class="section level2">
<h2>Final plot</h2>
<p>Final plot:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Q_df) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(.<span class="dv">10</span>, .<span class="dv">40</span>, .<span class="dv">60</span>, .<span class="dv">90</span>), <span class="at">color =</span> <span class="st">&quot;#cccccc&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(FlowExceedance, LDC,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">linetype =</span> <span class="st">&quot;Allowable Load at Geomean Criterion (126 MPN/100 mL)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(FlowExceedance, MeasuredLoad,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> <span class="st">&quot;Measurement Value (MPN/day)&quot;</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;Measurement Value (MPN/day)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> load_summary, <span class="fu">aes</span>(p, calcload, </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">shape =</span> <span class="st">&quot;Exisiting Geomean Load (MPN/day)&quot;</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">color =</span> <span class="st">&quot;Exisiting Geomean Load (MPN/day)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_logticks</span>(<span class="at">sides =</span> <span class="st">&quot;l&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#cccccc&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> .<span class="dv">05</span>, <span class="at">y =</span> <span class="fu">max</span>(Q_df<span class="sc">$</span>MeasuredLoad, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> (<span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">max</span>(Q_df<span class="sc">$</span>MeasuredLoad, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), <span class="at">label =</span> <span class="st">&quot;High</span><span class="sc">\n</span><span class="st">flows&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">family =</span> <span class="st">&quot;Arial Condensed&quot;</span>, <span class="at">lineheight =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> .<span class="dv">25</span>, <span class="at">y =</span> <span class="fu">max</span>(Q_df<span class="sc">$</span>MeasuredLoad, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> (<span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">max</span>(Q_df<span class="sc">$</span>MeasuredLoad, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), <span class="at">label =</span> <span class="st">&quot;Moist</span><span class="sc">\n</span><span class="st">conditions&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">family =</span> <span class="st">&quot;Arial Condensed&quot;</span>, <span class="at">lineheight =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> .<span class="dv">50</span>, <span class="at">y =</span> <span class="fu">max</span>(Q_df<span class="sc">$</span>MeasuredLoad, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> (<span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">max</span>(Q_df<span class="sc">$</span>MeasuredLoad, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), <span class="at">label =</span> <span class="st">&quot;Mid-range</span><span class="sc">\n</span><span class="st">flows&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">family =</span> <span class="st">&quot;Arial Condensed&quot;</span>, <span class="at">lineheight =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> .<span class="dv">75</span>, <span class="at">y =</span> <span class="fu">max</span>(Q_df<span class="sc">$</span>MeasuredLoad, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> (<span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">max</span>(Q_df<span class="sc">$</span>MeasuredLoad, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), <span class="at">label =</span> <span class="st">&quot;Dry</span><span class="sc">\n</span><span class="st">conditions&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">family =</span> <span class="st">&quot;Arial Condensed&quot;</span>, <span class="at">lineheight =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> .<span class="dv">95</span>, <span class="at">y =</span> <span class="fu">max</span>(Q_df<span class="sc">$</span>MeasuredLoad, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> (<span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">max</span>(Q_df<span class="sc">$</span>MeasuredLoad, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), <span class="at">label =</span> <span class="st">&quot;Low</span><span class="sc">\n</span><span class="st">flows&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">family =</span> <span class="st">&quot;Arial Condensed&quot;</span>, <span class="at">lineheight =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Proportion Time Load Exceeded&quot;</span>,</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;E. coli&quot;</span>), <span class="st">&quot; (MPN/day)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">name =</span> <span class="st">&quot;values&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">&quot;values&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>)) <span class="sc">+</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>,</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">5</span>))</span></code></pre></div>
<pre><code>## Warning: Removed 7599 rows containing missing values (geom_point).</code></pre>
<p><img src="document_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>

</div>

<center>
  <div class="footer">
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a><br />Text and figures are licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a> unless otherwise indicated.
  </div>
</center>

            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mps9506/twri-bookdown-template/edit/main/%s",
"text": "Suggest an edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["https://github.com/mps9506/twri-bookdown-template/raw/main/%s"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
